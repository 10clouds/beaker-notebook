{
  "id": "/beaker-dev",
  "apps": [
    {
      "id": "/beaker-dev/notebook",
      "cmd": "",
      "cpus": 0.1,
      "mem": 100,
      "ports": [
        3003
      ],
      "instances": 1,
      "container": {
        "type": "DOCKER",
        "docker": {
          "network": "BRIDGE",
          "image": "mojotech/bunsen-notebook",
          "portMappings": [
            {
              "containerPort": 3003,
              "servicePort": 3003,
              "protocol": "tcp"
            }
          ]
        }
      },
      "env": {
        "NOTEBOOK_PORT": 3003,
        "NOTEBOOK_DATABASE_URI": "datomic:mem://notebook",
        "NOTEBOOK_SEED_FILE": "seed.edn",
        "BAMBOO_HOST": "beaker-dev",
        "BAMBOO_PATH": "/notebook/"
      },
      "healthChecks": [
        {
          "protocol": "HTTP",
          "path": "/notebook/v1/status",
          "gracePeriodSeconds": 60,
          "intervalSeconds": 10,
          "portIndex": 0,
          "timeoutSeconds": 5,
          "maxConsecutiveFailures": 5
        }
      ],
      "upgradeStrategy": {
        "minimumHealthCapacity": 0
      }
    },
    {
      "id": "/beaker-dev/web",
      "args":["run"],
      "cpus": 0.1,
      "mem": 100,
      "instances": 1,
      "container": {
        "type": "DOCKER",
        "docker": {
          "network": "BRIDGE",
          "image": "mojotech/bunsen-web",
          "portMappings": [
            {
              "containerPort": 8081,
              "hostPort": 0,
              "servicePort": 8081,
              "protocol": "tcp"
            }
          ]
        }
      },
      "env": {
        "WEB_ROOT": "public",
        "BAMBOO_HOST": "beaker-dev",
        "BAMBOO_ACLS": "!{ path_beg -i /notebook/ }"
      },
      "healthChecks": [
        {
          "protocol": "HTTP",
          "path": "/",
          "gracePeriodSeconds": 10,
          "intervalSeconds": 10,
          "portIndex": 0,
          "timeoutSeconds": 5,
          "maxConsecutiveFailures": 3
        }
      ],
      "upgradeStrategy": {
        "minimumHealthCapacity": 0
      }
    }
  ]
}
