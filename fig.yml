app:
  build: app
  command: "--migrate --delay=5"
  links:
    - "db:db"
    - "provisioner:provisioner"
  ports:
    - "3000:3000"
  volumes:
    - "/vagrant/app:/var/app"
  environment:
    NODE_ENV: development
web:
  build: front_end
  command: "--watch --api_url='http://localhost:3000/api/'"
  ports:
    - "8080:8080"
  volumes:
    - "/vagrant/front_end:/var/www"
db:
  build: postgres
  ports:
    - "5432:5432"
  volumes:
    - "/var/bunsen_dbs:/var/lib/postgresql/9.1/main"
    - "/vagrant/postgres:/var/postgres"
  command: "--run"
beaker:
  build: beaker
  ports:
    - "8801:8801"
provisioner:
  build: provisioner
  ports:
    - "3001:3001"
  volumes:
    - "/var/run/docker.sock:/var/run/docker.sock"
    - "/vagrant/provisioner:/opt/provisioner"
  command: "bunsen_beaker"
gateway:
  build: gateway
  ports:
    - "7777:80"
  links:
    - "app:app"
    - "web:web"
  volumes:
    - "/dev/log:/dev/log"
    - "/var/run/docker.sock:/var/run/docker.sock"
  command: "bunsen_beaker localhost:7777"
